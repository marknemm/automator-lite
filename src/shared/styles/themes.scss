@use "sass:color";
@use "constants" as *;
@forward "constants";

/// Generates CSS variables for a color scale based on a base CSS variable.
/// @param {string} $base-var The base CSS variable name (e.g. --spark-info).
/// @param {color} $base-color The base color value.
/// @param {color} $inverted-color The inverted color value (optional, defaults to a dimmer shade of the base color).
@mixin color-variants(
  $base-var,
  $base-color,
  $inverted-color: color.adjust($base-color, $lightness: -30%)
) {
  #{$base-var}: #{$base-color};
  #{$base-var}-faint: #{rgba($base-color, 0.7)};
  #{$base-var}-fainter: #{rgba($base-color, 0.5)};
  #{$base-var}-faintest: #{rgba($base-color, 0.2)};
  #{$base-var}-dim: #{color.adjust($base-color, $lightness: -10%)};
  #{$base-var}-dimmer: #{color.adjust($base-color, $lightness: -15%)};
  #{$base-var}-dimmest: #{color.adjust($base-color, $lightness: -30%)};
  #{$base-var}-bright: #{color.adjust($base-color, $lightness: 10%)};
  #{$base-var}-brighter: #{color.adjust($base-color, $lightness: 15%)};
  #{$base-var}-brightest: #{color.adjust($base-color, $lightness: 30%)};
  #{$base-var}-inverted: #{$inverted-color};
  #{$base-var}-inverted-faint: #{rgba($inverted-color, 0.7)};
  #{$base-var}-inverted-fainter: #{rgba($inverted-color, 0.5)};
  #{$base-var}-inverted-faintest: #{rgba($inverted-color, 0.2)};
  #{$base-var}-inverted-dim: #{color.adjust($inverted-color, $lightness: -10%)};
  #{$base-var}-inverted-dimmer: #{color.adjust($inverted-color, $lightness: -15%)};
  #{$base-var}-inverted-dimmest: #{color.adjust($inverted-color, $lightness: -30%)};
  #{$base-var}-inverted-bright: #{color.adjust($inverted-color, $lightness: 10%)};
  #{$base-var}-inverted-brighter: #{color.adjust($inverted-color, $lightness: 15%)};
  #{$base-var}-inverted-brightest: #{color.adjust($inverted-color, $lightness: 30%)};
}

/// Generates shadow variants based on a base shadow color.
/// @param {color} $shadow-color The base shadow color (e.g. #000).
@mixin shadow-variants($shadow-color) {
  --spark-shadow-color: #{$shadow-color};
  --spark-shadow: 0px 3px 5px -1px #{rgba($shadow-color, 0.2)},
                  0px 6px 10px 0px #{rgba($shadow-color, 0.14)},
                  0px 1px 18px 0px #{rgba($shadow-color, 0.12)};
  --spark-shadow-light: 0px 2px 1px -1px #{rgba($shadow-color, 0.2)},
                        0px 1px 1px 0px #{rgba($shadow-color, 0.14)},
                        0px 1px 3px 0px #{rgba($shadow-color, 0.12)};
  --spark-shadow-heavy: 0px 5px 5px -3px #{rgba($shadow-color, .2)},
                        0px 8px 10px 1px #{rgba($shadow-color, .14)},
                        0px 3px 14px 2px #{rgba($shadow-color, .12)};
}

/// Generates common theme variables for a component.
/// @param {string} $component-name The component name to prefix the variables (e.g. "modal").
/// @param {color} $background The background color variable (default: var(--spark-background)).
/// @param {color} $border-color The border color variable (default: var(--spark-border-color)).
/// @param {string} $border-style The border style variable (default: unset).
/// @param {string} $border-radius The border radius variable (default: unset).
/// @param {string} $box-shadow The box shadow variable (default: unset).
/// @param {string} $font-family The font family variable (default: var(--spark-font-family)).
/// @param {string} $font-size The font size variable (default: var(--spark-font-size)).
/// @param {color} $foreground The foreground color variable (default: var(--spark-foreground)).
/// @param {string} $height The height variable (default: unset).
/// @param {string} $line-height The line height variable (default: var(--spark-line-height)).
/// @param {string} $margin The margin variable (default: unset).
/// @param {string} $margin-bottom The margin bottom variable (default: unset).
/// @param {string} $margin-horizontal The margin horizontal variable (default: unset).
/// @param {string} $margin-left The margin left variable (default: unset).
/// @param {string} $margin-right The margin right variable (default: unset).
/// @param {string} $margin-top The margin top variable (default: unset).
/// @param {string} $margin-vertical The margin vertical variable (default: unset).
/// @param {string} $max-height The max height variable (default: unset).
/// @param {string} $max-width The max width variable (default: unset).
/// @param {string} $min-height The min height variable (default: unset).
/// @param {string} $min-width The min width variable (default: unset).
/// @param {string} $padding The padding variable (default: unset).
/// @param {string} $padding-bottom The padding bottom variable (default: unset).
/// @param {string} $padding-horizontal The padding horizontal variable (default: unset).
/// @param {string} $padding-left The padding left variable (default: unset).
/// @param {string} $padding-right The padding right variable (default: unset).
/// @param {string} $padding-top The padding top variable (default: unset).
/// @param {string} $padding-vertical The padding vertical variable (default: unset).
/// @param {string} $width The width variable (default: unset).
/// @param {string} $z-index The z-index variable (default: unset).
@mixin component-theme-variables(
  $component-name,
  $background: var(--spark-background),
  $border-color: var(--spark-border-color),
  $border-radius: unset,
  $border-style: unset,
  $border-width: unset,
  $box-shadow: unset,
  $font-family: var(--spark-font-family),
  $font-size: var(--spark-font-size),
  $font-weight: unset,
  $foreground: var(--spark-foreground),
  $height: unset,
  $line-height: var(--spark-line-height),
  $margin: unset,
  $margin-bottom: unset,
  $margin-horizontal: unset,
  $margin-left: unset,
  $margin-right: unset,
  $margin-top: unset,
  $margin-vertical: unset,
  $max-height: unset,
  $max-width: unset,
  $min-height: unset,
  $min-width: unset,
  $padding: unset,
  $padding-bottom: unset,
  $padding-horizontal: unset,
  $padding-left: unset,
  $padding-right: unset,
  $padding-top: unset,
  $padding-vertical: unset,
  $width: unset,
  $z-index: unset
) {
  @if $background != unset      { --spark-#{$component-name}-background: #{$background}; }
  @if $border-color != unset    { --spark-#{$component-name}-border-color: #{$border-color}; }
  @if $border-radius != unset   { --spark-#{$component-name}-border-radius: #{$border-radius}; }
  @if $border-style != unset     { --spark-#{$component-name}-border-style: #{$border-style}; }
  @if $border-width != unset     { --spark-#{$component-name}-border-width: #{$border-width}; }
  @if $box-shadow != unset      { --spark-#{$component-name}-box-shadow: #{$box-shadow}; }
  @if $font-family != unset     { --spark-#{$component-name}-font-family: #{$font-family}; }
  @if $font-size != unset       { --spark-#{$component-name}-font-size: #{$font-size}; }
  @if $font-weight != unset     { --spark-#{$component-name}-font-weight: #{$font-weight}; }
  @if $foreground != unset      { --spark-#{$component-name}-foreground: #{$foreground}; }
  @if $height != unset          { --spark-#{$component-name}-height: #{$height}; }
  @if $line-height != unset     { --spark-#{$component-name}-line-height: #{$line-height}; }

  // Margin with fallback priority: specific > horizontal/vertical > all
  @if $margin-top != unset or $margin-vertical != unset or $margin != unset {
    --spark-#{$component-name}-margin-top: #{if($margin-top != unset, $margin-top, if($margin-vertical != unset, $margin-vertical, $margin))};
  }
  @if $margin-right != unset or $margin-horizontal != unset or $margin != unset {
    --spark-#{$component-name}-margin-right: #{if($margin-right != unset, $margin-right, if($margin-horizontal != unset, $margin-horizontal, $margin))};
  }
  @if $margin-bottom != unset or $margin-vertical != unset or $margin != unset {
    --spark-#{$component-name}-margin-bottom: #{if($margin-bottom != unset, $margin-bottom, if($margin-vertical != unset, $margin-vertical, $margin))};
  }
  @if $margin-left != unset or $margin-horizontal != unset or $margin != unset {
    --spark-#{$component-name}-margin-left: #{if($margin-left != unset, $margin-left, if($margin-horizontal != unset, $margin-horizontal, $margin))};
  }

  @if $max-height != unset      { --spark-#{$component-name}-max-height: #{$max-height}; }
  @if $max-width != unset       { --spark-#{$component-name}-max-width: #{$max-width}; }
  @if $min-height != unset      { --spark-#{$component-name}-min-height: #{$min-height}; }
  @if $min-width != unset       { --spark-#{$component-name}-min-width: #{$min-width}; }

  // Padding with fallback priority: specific > horizontal/vertical > all
  @if $padding-top != unset or $padding-vertical != unset or $padding != unset {
    --spark-#{$component-name}-padding-top: #{if($padding-top != unset, $padding-top, if($padding-vertical != unset, $padding-vertical, $padding))};
  }
  @if $padding-right != unset or $padding-horizontal != unset or $padding != unset {
    --spark-#{$component-name}-padding-right: #{if($padding-right != unset, $padding-right, if($padding-horizontal != unset, $padding-horizontal, $padding))};
  }
  @if $padding-bottom != unset or $padding-vertical != unset or $padding != unset {
    --spark-#{$component-name}-padding-bottom: #{if($padding-bottom != unset, $padding-bottom, if($padding-vertical != unset, $padding-vertical, $padding))};
  }
  @if $padding-left != unset or $padding-horizontal != unset or $padding != unset {
    --spark-#{$component-name}-padding-left: #{if($padding-left != unset, $padding-left, if($padding-horizontal != unset, $padding-horizontal, $padding))};
  }

  @if $width != unset           { --spark-#{$component-name}-width: #{$width}; }
  @if $z-index != unset         { --spark-#{$component-name}-z-index: #{$z-index}; }
}


// ############################## //
// Light Theme (Default)
:root, :host {
  --spark-gutter: 8px;
  --spark-field-border-radius: 4px;
  --spark-font-size: 14px;
  --spark-line-height: normal;
  --spark-font-family: #{$sans-serif-font-family}, sans-serif;
  --spark-font-family-serif: #{$serif-font-family}, serif;
  --spark-overlay-z-index: 1000;

  // Light Theme Colors
  $spark-background: #fff;
  --spark-background: #{$spark-background};
  --spark-background-dim: #f5f5f5;
  --spark-background-dimmer: #f0f0f0;
  --spark-background-dimmest: #e0e0e0;

  $spark-foreground: #000;
  --spark-foreground: #{$spark-foreground};
  --spark-foreground-dim: #333;
  --spark-foreground-dimmer: #666;
  --spark-foreground-dimmest: #999;

  --spark-input-background: var(--spark-background);
  --spark-input-foreground: var(--spark-foreground);
  --spark-input-disabled: var(--spark-background-dimmest);

  $spark-border-color: #ccc;
  --spark-border-color: #{$spark-border-color};

  @include shadow-variants($spark-foreground);

  @include color-variants(--spark-info, #007bff, #fff);
  @include color-variants(--spark-success, #28a745, #fff);
  @include color-variants(--spark-warn, #ffc107, #000);
  @include color-variants(--spark-danger, #dc3545, #fff);
  @include color-variants(--spark-primary, #007bff, #cceaff);
  @include color-variants(--spark-secondary, #6c757d, #fff);
  @include color-variants(--spark-tertiary, #fff, #000);
}


// ############################## //
// Dark Theme
@media (prefers-color-scheme: dark) {
  :root, :host {
    $spark-background: #222;
    --spark-background: #{$spark-background};
    --spark-background-dim: #{color.adjust($spark-background, $lightness: 3%)};
    --spark-background-dimmer: #{color.adjust($spark-background, $lightness: 6%)};
    --spark-background-dimmest: #{color.adjust($spark-background, $lightness: 12%)};

    $spark-foreground: #e0e0e0;
    --spark-foreground: #{$spark-foreground};
    --spark-foreground-dim: #{color.adjust($spark-foreground, $lightness: -3%)};
    --spark-foreground-dimmer: #{color.adjust($spark-foreground, $lightness: -6%)};
    --spark-foreground-dimmest: #{color.adjust($spark-foreground, $lightness: -12%)};

    $spark-border-color: #333;
    --spark-border-color: #{$spark-border-color};

    @include shadow-variants(color.adjust($spark-foreground, $lightness: -28%));

    --spark-input-background: var(--spark-background-dimmest);
    --spark-input-foreground: var(--spark-foreground);
    --spark-input-disabled: var(--spark-background);

    @include color-variants(--spark-info, #01b2b2);
    @include color-variants(--spark-success, #34a853);
    @include color-variants(--spark-warn, #fbbc05);
    @include color-variants(--spark-danger, #ea4335);
    @include color-variants(--spark-primary, #1a73e8);
    @include color-variants(--spark-secondary, #b0cccb);
    @include color-variants(--spark-tertiary, #ffb787);
  }
}

.spark-color-info,
.spark[color="info"] {
  background: var(--spark-info);
  color: var(--spark-info-inverted);
}

.spark-color-success,
.spark[color="success"] {
  background: var(--spark-success);
  color: var(--spark-success-inverted);
}

.spark-color-warning,
.spark[color="warning"] {
  background: var(--spark-warn);
  color: var(--spark-warn-inverted);
}

.spark-color-danger,
.spark[color="danger"] {
  background: var(--spark-danger);
  color: var(--spark-danger-inverted);
}

.spark-color-primary,
.spark[color="primary"] {
  background: var(--spark-primary);
  color: var(--spark-primary-inverted);
}

.spark-color-secondary,
.spark[color="secondary"] {
  background: var(--spark-secondary);
  color: var(--spark-secondary-inverted);
}

.spark-color-tertiary,
.spark[color="tertiary"] {
  background: var(--spark-tertiary);
  color: var(--spark-tertiary-inverted);
}
